<!doctype html><html lang="de"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bieterverfahren (Light)</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head><body class="bg-light">
<div class="container py-4">
  <a class="btn btn-sm btn-outline-secondary mb-3" href="index.html#news">← Zurück</a>
  <h1 class="h4">Bieterverfahren (Light) – moderiert</h1>
  <p class="small text-muted">Gebote werden als GitHub-Issues erfasst. Nur <span class="badge bg-success">approved</span>-Issues zählen.</p>
  <div class="d-flex gap-2 mb-3">
    <a id="newIssue" class="btn btn-primary" target="_blank" rel="noopener">Gebot abgeben</a>
    <a href="https://github.com/OWNER/REPO/issues?q=is%3Aissue+is%3Aopen+label%3Agebot" class="btn btn-outline-secondary" target="_blank">Alle Gebote ansehen</a>
  </div>
  <div id="list" class="row g-3"></div>
  <p class="small text-muted mt-3">Hinweis: Dieses Feature speichert keine personenbezogenen Daten auf Deiner Seite. Alles liegt transparent bei GitHub.</p>
</div>
<script>
const OWNER="OWNER"; // TODO: GitHub-Owner einsetzen
const REPO="REPO";   // TODO: Repo-Name einsetzen
document.getElementById('newIssue').href = `https://github.com/${OWNER}/${REPO}/issues/new?template=gebot.yml`;
async function loadIssues(){
  const url = `https://api.github.com/repos/${OWNER}/${REPO}/issues?labels=gebot&state=open&per_page=50`;
  try{
    const r = await fetch(url); const items = await r.json();
    const list = document.getElementById('list');
    if(!Array.isArray(items)){ list.innerHTML = "<div class='col-12'>Keine Daten.</div>"; return; }
    list.innerHTML = items.map(i=>{
      const approved = (i.labels||[]).some(l=> (l.name||"")==="approved" );
      return `<div class="col-md-6">
        <div class="card p-3">
          <div class="d-flex justify-content-between align-items-center">
            <strong>${i.title}</strong>
            ${approved?'<span class="badge bg-success">approved</span>':'<span class="badge bg-secondary">review</span>'}
          </div>
          <div class="small text-muted mb-2">#${i.number} · ${new Date(i.created_at).toLocaleDateString('de-DE')}</div>
          <a class="btn btn-sm btn-outline-primary" href="${i.html_url}" target="_blank">Details / kommentieren</a>
        </div>
      </div>`;
    }).join('');
  }catch(e){
    document.getElementById('list').innerHTML = "<div class='col-12'>Laden der Gebote derzeit nicht möglich.</div>";
  }
}
loadIssues();
</script>
</body></html>
