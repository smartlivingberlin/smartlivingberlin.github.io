<!doctype html><html lang="de"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Grundriss: Tricks & Praxis</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
.figure-compare{position:relative;max-width:900px;overflow:hidden;border-radius:12px}
.figure-compare img{display:block;width:100%;height:auto}
.figure-compare .clip{position:absolute;inset:0;overflow:hidden}
.figure-compare input[type=range]{position:absolute;left:0;right:0;bottom:8px;width:100%}
#canvas{width:100%;max-width:720px;border:1px dashed #bbb;border-radius:12px;background:#fff}
</style>
</head><body class="container py-4">
<a href="../index.html" class="btn btn-link">&larr; Zurück</a>
<h1 class="mb-2">Grundriss: Tricks & Praxis</h1>
<p class="lead">Vorher/Nachher-Vergleich & kleine Möbel-Blöcke in eine Skizze setzen – inkl. PNG-Export.</p>
<hr>

<h3 class="mt-3">1) Vorher / Nachher (Schieberegler)</h3>
<div class="figure-compare mb-2">
  <img src="https://images.unsplash.com/photo-1505693416388-ac5ce068fe85?q=80&w=1600" alt="Vorher">
  <div class="clip" id="after" style="width:50%">
    <img src="https://images.unsplash.com/photo-1616594039964-ae9021a80b7b?q=80&w=1600" alt="Nachher">
  </div>
  <input type="range" min="0" max="100" value="50" oninput="document.getElementById('after').style.width=this.value+'%';" aria-label="Schieberegler Vorher/Nachher">
</div>

<h3 class="mt-4">2) Grundriss-Skizze + Export</h3>
<input type="file" accept="image/*" class="form-control mb-2" onchange="loadPlan(event)">
<canvas id="canvas" height="460" aria-label="Grundriss Fläche"></canvas>
<div class="mt-2">
  <button class="btn btn-sm btn-secondary me-2" onclick="addBlock()">+ Möbel-Block</button>
  <button class="btn btn-sm btn-outline-danger me-2" onclick="clearBlocks()">Canvas leeren</button>
  <button class="btn btn-sm btn-success" onclick="exportPNG()">Als PNG speichern</button>
</div>
<p class="small text-muted mt-2">Tipp: Falls du kein Bild lädst, verwenden wir ein Demo-Plan (falls vorhanden).</p>

<script>
let plan=null, blocks=[];
function loadPlan(e){
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=()=>{ plan=new Image(); plan.onload=draw; plan.src=r.result; };
  r.readAsDataURL(f);
}
function draw(){
  const c=document.getElementById('canvas'); const ctx=c.getContext('2d');
  ctx.clearRect(0,0,c.width,c.height);
  if(plan){
    const r=Math.min(c.width/plan.width,c.height/plan.height);
    const w=plan.width*r,h=plan.height*r;
    ctx.drawImage(plan,(c.width-w)/2,(c.height-h)/2,w,h);
  }
  blocks.forEach(b=>{ ctx.fillStyle='rgba(25,135,84,.2)'; ctx.fillRect(b.x,b.y,b.w,b.h);
                      ctx.strokeStyle='rgba(25,135,84,.9)'; ctx.strokeRect(b.x,b.y,b.w,b.h); });
}
function addBlock(){ blocks.push({x:40+blocks.length*20,y:40,w:90,h:60}); draw(); }
function clearBlocks(){ blocks=[]; draw(); }
function exportPNG(){
  const a=document.createElement('a');
  a.download='grundriss-skizze.png';
  a.href=document.getElementById('canvas').toDataURL('image/png');
  a.click();
}
// Demo-Plan laden, wenn vorhanden
window.addEventListener('load',()=>{
  const demo='../../assets/img/plans/muster-plan-1.png';
  fetch(demo).then(r=>{ if(r.ok){ plan=new Image(); plan.onload=draw; plan.src=demo; }});
});
</script>
</body></html>
